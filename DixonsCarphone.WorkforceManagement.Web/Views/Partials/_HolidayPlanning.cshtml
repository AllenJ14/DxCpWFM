@using DixonsCarphone.WorkforceManagement.ViewModels.BusinessModels
@model HolidayPlanningVM

@{ 
    Func<char, string> ragFormat = (c) =>
    {
        string result = "success";
        if (c == 'R')
        {
            result = "danger";
        }
        else if (c == 'A')
        {
            result = "warning";
        }
        return result;
    };
}

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="col-md-12">
                    <div class="text-center col-md-6 col-md-offset-3">
                        <table class="table table-bordered-blue table-condensed">
                            <thead>
                                <tr>
                                    <th class="text-center col-md-2 col-sm-2">Taken</th>
                                    <th class="text-center col-md-2 col-sm-2">Goal</th>
                                    <th class="text-center col-md-2 col-sm-2">%</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-center">@Model.TotalTaken</td>
                                    <td class="text-center">@Model.TotalToTake</td>
                                    <td class="text-center">@string.Format("{0:0}%", Model.PercTaken * 100)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    @if (Model.PercTaken < 1)
                    {
                        <span class="col-md-12 text-center" style="font-size:x-small"><strong>You are underspent on holiday YTD, this may cause issues with availability later in the year.</strong></span>
                    }
                    <div class="box-body col-md-12">
                        <div class="chart">
                            <canvas id="holiday-chart" style="height:250px"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading text-center">
                <div class="row">
                    <strong>Detail Breakdown</strong>
                </div>
            </div>
            <div class="panel-body">
                <p class="text-center">
                    RAG status is calculated based on how close holiday spend is to the overall guideline shown above.</br>
                    <strong style="color:green">Green: </strong>less than 20% off</br>
                    <strong style="color:orange">Amber: </strong>more than 20% off</br>
                    <strong style="color:red">Red: </strong>more than 40% off</br>
                </p>
                <table class="table table-bordered-blue table-condensed">
                    <thead>
                        <tr>
                            <th class="text-center">Name</th>
                            <th class="text-center col-md-2 col-sm-2">Holiday Balance</th>
                            <th class="text-center col-md-2 col-sm-2">Holiday Taken</th>
                            <th class="text-center col-md-2 col-sm-2">RAG</th>
                            <th class="text-center col-md-2 col-sm-2">Planned</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach(var item in Model.DetailCollection)
                        {
                            var _rag = item.RAG(Model.PercToTake);
                            <tr>
                                <td>@item.ID</td>
                                <td class="text-center">@item.BalanceRemaining</td>
                                <td class="text-center">@item.HolidayTaken</td>
                                <td class="text-center @(ragFormat(_rag))")>@_rag</td>
                                <td class="text-center">@item.Planned</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
